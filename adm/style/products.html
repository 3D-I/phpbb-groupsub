{% include 'overall_header.html' %}

<a id="maincontent"></a>

{% if S_ADD_PROD or S_EDIT_PROD %}

	<a href="{{ U_BACK }}" style="float: {{ S_CONTENT_FLOW_END }};">&laquo; {{ lang('BACK') }}</a>

	{% if ERROR_MSG %}
		<div class="errorbox">
			<h3>{{ lang('WARNING') }}</h3>
			<p>{{ ERROR_MSG }}</p>
		</div>
	{% endif %}

	{% if S_ADD_PROD %}
		<h1>{{ lang('ACP_GROUPSUB_PROD_ADD') }}</h1>
	{% else %}
		<h1>{{ lang('ACP_GROUPSUB_PROD_EDIT') }} :: {{ PROD_NAME }}</h1>
	{% endif %}

	<form id="add_edit_prod" method="post" action="{{ U_ACTION }}">
		<fieldset>
			<legend>{{ lang('ACP_GROUPSUB_PROD_DETAILS')}}</legend>
			{% if S_ADD_PROD %}
				<dl>
					<dt><label for="prod_ident">{{ lang('ACP_GROUPSUB_PROD_IDENT') ~ lang('COLON') }}</label><br /><span>{{ lang('ACP_GROUPSUB_PROD_IDENT_EXPLAIN') }}</span></dt>
					<dd><input class="text medium" type="text" id="prod_ident" name="prod_ident" value="{{ PROD_IDENT }}" maxlength="30" /></dd>
				</dl>
			{% else %}
				<dl>
					<dt>{{ lang('ACP_GROUPSUB_PROD_IDENT') ~ lang('COLON') }}</dt>
					<dd>{{ PROD_IDENT }}</dd>
				</dl>
			{% endif %}
			<dl>
				<dt><label for="prod_name">{{ lang('ACP_GROUPSUB_PROD_NAME') ~ lang('COLON') }}</label></dt>
				<dd><input class="text medium" type="text" id="prod_name" name="prod_name" value="{{ PROD_NAME }}" maxlength="255" /></dd>
			</dl>
			<dl>
				<dt><label for="prod_desc">{{ lang('ACP_GROUPSUB_PROD_DESC') ~ lang('COLON') }}</label></dt>
				<dd><textarea id="prod_desc" name="prod_desc" rows="5" cols="45" data-bbcode="true">{{ PROD_DESC }}</textarea></dd>
				<dd>
					<label><input type="checkbox" class="radio" name="parse_bbcode"{% if S_PARSE_BBCODE_CHECKED %} checked="checked"<{% endif %} /> {{ lang('PARSE_BBCODE') }}</label>
					<label><input type="checkbox" class="radio" name="parse_smilies"<{% if S_PARSE_SMILIES_CHECKED %} checked="checked"<{% endif %} /> {{ lang('PARSE_SMILIES') }}</label>
					<label><input type="checkbox" class="radio" name="parse_magic_url"<{% if S_PARSE_MAGIC_URL_CHECKED %} checked="checked"<{% endif %} /> {{ lang('PARSE_URLS') }}</label>
				</dd>
			</dl>
		</fieldset>
		<fieldset>
			<legend>{{ lang('ACP_GROUPSUB_PROD_GROUPS')}}</legend>
			<dl>
				<dt><label for="prod_groups">{{ lang('ACP_GROUPSUB_PROD_GROUPS') ~ lang('COLON') }}</label><br /><span>{{ lang('ACP_GROUPSUB_PROD_GROUPS_EXPLAIN') }}</span></dt>
				<dd>
					<select name="prod_groups[]" id="prod_groups" multiple="multiple" size="10">
						{% for g in group %}
							<option value="{{ g.GROUP_ID }}"{% if g.S_SELECTED %} selected="selected"{% endif %}>{{ g.GROUP_NAME }}</option>
						{% endfor %}
					</select>
				</dd>
			</dl>
		</fieldset>
		<fieldset>
			<legend>{{ lang('ACP_GROUPSUB_PROD_PRICES') }}</legend>
			<table class="table1 zebra-table responsive">
				<thead>
					<th style="width: 10%">{{ lang('ACP_GROUPSUB_PRICE') }}</th>
					<th style="width: 10%">{{ lang('ACP_GROUPSUB_LENGTH') }}</th>
					<th style="width: 10%">{{ lang('ACTION') }}</th>
				</thead>
				<tbody>
				{% for p in price %}
					<tr>
						<td>
							<input type="text" name="prod_price[]" value="{{ p.PROD_PRICE }}">
							<select name="prod_currency[]">
							{% for c in currency %}
							    <option value="{{ c.CURRENCY }}"{% if c.CURRENCY == p.PROD_CURRENCY %} selected="selected" {% endif %}>{{ c.CURRENCY }} {{ c.SYMBOL }}</option>
							{% endfor %}
							</select>
						</td>
						<td>
							<input type="text" name="prod_length[]" value="{{ p.PROD_LENGTH }}">
							<select name="prod_length_unit[]">
							{% for u in time_unit %}
								<option value="{{ u.UNIT_ID }}"{% if u.UNIT_ID == p.PROD_LENGTH_UNIT %} selected="selected"{% endif %}>{{ u.UNIT_NAME }}</option>
							{% endfor %}
							</select>
						</td>
						<td class="actions">
							<span class="up-disabled" style="display:none;">{{ ICON_MOVE_UP_DISABLED }}</span>
							<span class="up"><a href="{{ p.U_MOVE_UP }}" data-ajax="row_up">{{ ICON_MOVE_UP }}</a></span>
							<span class="down-disabled" style="display:none;">{{ ICON_MOVE_DOWN_DISABLED }}</span>
							<span class="down"><a href="{{ p.U_MOVE_DOWN }}" data-ajax="row_down">{{ ICON_MOVE_DOWN }}</a></span>
							<a href="{{ p.U_DELETE }}" data-ajax="row_delete">{{ ICON_DELETE }}</a>
						</td>
					</tr>
				{% endfor %}
				</tbody>
			</table>
			<fieldset>
				<legend>{{ lang('ACP_GROUPSUB_PROD_PRICE_ADD')}}</legend>
				<dl>
					<dt><label for="prod_price">{{ lang('ACP_GROUPSUB_PROD_PRICE') ~ lang('COLON') }}</label><br /><span>{{ lang('ACP_GROUPSUB_PROD_PRICE_EXPLAIN') }}</span></dt>
					<dd>
						<input class="text" type="text" id="prod_price" name="prod_price[]" size="4" maxlength="10" value="{{ PROD_PRICE }}" />&nbsp;
						<select name="prod_currency[]" id="prod_currency">
							{% for c in currency %}
								<option value="{{ c.CURRENCY }}"{% if c.S_DEFAULT %} selected="selected"{% endif %}>{{ c.CURRENCY }} ({{ c.SYMBOL }})</option>
							{% endfor %}
						</select>
					</dd>
				</dl>
				<dl>
					<dt><label for="prod_length">{{ lang('ACP_GROUPSUB_PROD_LENGTH') ~ lang('COLON') }}</label><br /><span>{{ lang('ACP_GROUPSUB_PROD_LENGTH_EXPLAIN') }}</span></dt>
					<dd>
						<input class="text" type="text" id="prod_length" name="prod_length[]" size="4" maxlength="10" value="{{ PROD_LENGTH }}" />&nbsp;
						<select name="prod_length_unit[]" id="prod_length_unit">
							{% for u in time_unit %}
								<option value="{{ u.UNIT_ID }}">{{ u.UNIT_NAME }}</option>
							{% endfor %}
						</select>
					</dd>
				</dl>
				<input class="button2" type="submit" name="add_price" value="{{ lang('ACP_GROUPSUB_PROD_PRICE_ADD') }}">
			</fieldset>
		</fieldset>
		<fieldset>
			<legend>{{ lang('ACP_GROUPSUB_PROD_SUB')}}</legend>
			<dl>
				<dt><label for="prod_warn_time">{{ lang('ACP_GROUPSUB_PROD_WARN_TIME') ~ lang('COLON') }}</label><br /><span>{{ lang('ACP_GROUPSUB_PROD_WARN_TIME_EXPLAIN') }}</span></dt>
				<dd><input class="text" type="text" id="prod_warn_time" name="prod_warn_time" size="4" maxlength="10" value="{{ PROD_WARN_TIME }}" />&nbsp;{{ lang('GROUPSUB_DAYS') }}</dd>
			</dl>
			<dl>
				<dt><label for="prod_grace">{{ lang('ACP_GROUPSUB_PROD_GRACE') ~ lang('COLON') }}</label><br /><span>{{ lang('ACP_GROUPSUB_PROD_GRACE_EXPLAIN') }}</span></dt>
				<dd><input class="text" type="text" id="prod_grace" name="prod_grace" size="4" maxlength="10" value="{{ PROD_GRACE }}" />&nbsp;{{ lang('GROUPSUB_DAYS') }}</dd>
			</dl>
		</fieldset>
		<fieldset class="submit-buttons">
			<input class="button1" type="submit" id="submit" name="submit" value="{{ lang('SUBMIT') }}" />&nbsp;
			<input class="button2" type="reset" id="reset" name="reset" value="{{ lang('RESET') }}" />
			{{ S_FORM_TOKEN }}
		</fieldset>
	</form>

{% else %}

	<h1>{{ lang('ACP_GROUPSUB_MANAGE_PRODS') }}</h1>

	<p>{{ lang('ACP_GROUPSUB_MANAGE_PRODS_EXPLAIN') }}</p>

	<table class="table1 zebra-table responsive">
		<thead>
			<th style="width: 10%">{{ lang('ACP_GROUPSUB_PROD') }}</th>
			<th>{{ lang('ACP_GROUPSUB_NAME') }}</th>
			<th style="width: 30%">{{ lang('ACP_GROUPSUB_PRICES') }}</th>
			<th style="width: 10%">{{ lang('ACTION') }}</th>
		</thead>
		<tbody>
			{% for p in product %}
				<tr>
					<td>{{ p.PROD_IDENT }}</td>
					<td><strong>{{ p.PROD_NAME }}</strong></td>
					<td>
					{% if p.price %}
						<table>
						{% for price in p.price %}
							<tr>
								<td>{{ price.PROD_PRICE }}</td>
								<td>{% if price.PROD_LENGTH %}{{ price.PROD_LENGTH }}{% else %}<i>{{ lang('ACP_GROUPSUB_EXPIRES_UNLIMITED') }}</i>{% endif %}</td>
							</tr>
						{% endfor %}
						</table>
					{% endif %}
					</td>
					<td class="actions">
						<span class="up-disabled" style="display:none;">{{ ICON_MOVE_UP_DISABLED }}</span>
						<span class="up"><a href="{{ p.U_MOVE_UP }}" data-ajax="row_up">{{ ICON_MOVE_UP }}</a></span>
						<span class="down-disabled" style="display:none;">{{ ICON_MOVE_DOWN_DISABLED }}</span>
						<span class="down"><a href="{{ p.U_MOVE_DOWN }}" data-ajax="row_down">{{ ICON_MOVE_DOWN }}</a></span>
						<a href="{{ p.U_EDIT }}">{{ ICON_EDIT }}</a>
						<a href="{{ p.U_DELETE }}" data-ajax="row_delete">{{ ICON_DELETE }}</a>
					</td>
				</tr>
			{% else %}
				<tr>
					<td colspan="4" style="text-align: center;">{{ lang('ACP_GROUPSUB_NO_PRODS') }}</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>

	<form id="prod_add" method="post" action="{{ U_ADD_PROD }}">
		<fieldset class="quick">
			<input class="button2" type="submit" name="add" value="{{ lang('ACP_GROUPSUB_PROD_ADD') }}" />
		</fieldset>
	</form>

{% endif %}

{% include 'overall_footer.html' %}
